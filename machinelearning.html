<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width-device-width, initial-scale=1.0">
    <title>Matthew Olsson - Machine Learning</title>
    <link href="style.css" rel ="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
</head>

<body>
    <nav class = "navbar">
        <a href="index.html" class = "navlogo">Matthew Olsson</a>
        <ul>
            <li><a href="index.html">home</a></li>
            <li><a href="projects.html">projects</a></li>
            <li><a href="notes.html">notes</a></li>
            <li><a href="blog.html">blog</a></li>
        </ul>
    </nav>
    <main>
        <div class="project">
            <h1>machine learning for python</h1>
            <p>An online lecture presented by <i>Programming with Mosh</i> that is a beginner tutorial on using machine learning with Python. The tutorial utilizes the Scikit-learn, Pandas, Numpy, and Matplotlib packages. The lecture can be found at <a href="https://www.youtube.com/watch?v=7eh4d6sabA0">here</a>.</p>
            <br> 
            <h2>Contents</h2>
                <ol>
                    <li>Introduction to Machine Learning</li>
                    <li>Tooling</li>
                    <li>Problems</li>
                </ol>
            <br>
            
            <h2>What is machine learning?</h2>
                <ul class="notes">
                    <li>Machine learning is a subset of A.I</li>
                    <li>"The study of computer algorithms that improve automatically through experience and by the use of data."</li>
                    <li>Ex. Image recognition software works by feeding algorithms man pictures of each until it can differentiate the two</li>
                    <li>Ex. Self driving cars, robotics, language processing, etc.</li>
                </ul>
            <br>

            <h2>Steps</h2>
                <ol>
                    <li>Import the data (typically in a .csv file)</li>
                    <li>Clean the data (to combat the machine learning bad, irrelevant, or duplicated data)</li>
                    <li>Split the data into training/test steps (perhaps 80% for training, 20% for tests)</li>
                    <li>Create a model (select an algorithm(s) to analyze the data)</li>
                    <li>Train the model (looks for patterns in the data)</li>
                    <li>Make predictions by way of the model</li>
                    <li>Evaluate and improve the model</li>
                </ol>
            <br>
            
            <h2>Libraries and Tools</h2>
                <ul class="notes">
                    <li>Numpy, mainly used for multy dimensional array</li>
                    <li>Pandas, a data science package mainly used for its data framing (similar to excel)</li>
                    <li>Matplotlib, mainly used for its 2D plotting</li>
                    <li>Scikit-Learn, the most popular machine learning library (contains decision trees, neural networks, etc.)</li>
                </ul>
            <br>

            <h2>Environments</h2>
                <ul class="notes">
                    <li>Any environment will of course work but for machine learning Jupyter works best</li>
                    <li>This is due to the frequent inspection of the data</li>
                </ul>
            <br>

            <h2>Importing Data Sets</h2>
                <dl>
                    <dt>Kaggle is the most popular data set website</dt>
                    <dt>Sample Code</dt>
                        <dd style="font-family:'Courier New', Courier, monospace">import pandas as pd #pd is the standard abbreviation<br>
                            df = pd.read_csv('filename.csv') #df denotes dataframe<br>
                            df #displays the actual data in the way it is presented<br>
                            df.shape #displays the number of rows by the number of columns<br>
                            df.describe() #returns the describe command<br>
                            df.values #returns the value command<br></dd>
                    <dt>Read</dt>
                        <dd>The read command allows the code to load it and read the csv file in its entirety</dd>
                    <dt>Shape</dt>
                        <dd>Displays the number of rows by the number of columns</dd>
                        <dd>This is the 'shape' of the data frame</dd>
                    <dt>Describe</dt>
                        <dd>Returns basic numerical information about each column in the data set</dd>
                        <dd>It contains count, mean, standard deviation, min, 25%, etc.</dd>
                    <dt>Values</dt>
                        <dd>Presents the data in an array in a row by row fashion</dd>
                </dl>
            <br>

            <h2>Jupyter Shortcuts</h2>
                <ul class="notes">
                    <li>'Esc' key enables the active cell to turn into the command mode</li>
                    <li>Pressing 'H' in the command mode displays all the shortcuts in Jupyter</li>
                    <li>'Crtl + Enter' runs the current cell without creating a new one below it</li>
                </ul>
            <br>

            <h2>Example</h2>
                <ul class="notes">
                    <li>Creating a model to predict songs for a user</li>
                    <li>Take in some basic information like age, gender, preferred genres, etc.</li>
                    <li>Implement the steps for machine learning</li>
                </ul>
            <br>

            <h2>Importing</h2>
                <dl>
                    <dt>This step imports the proper packages and data for the project</dt>
                        <dd style="font-family:'Courier New', Courier, monospace">import pandas as pd<br>
                            music_data = pd.read_csv('music.csv')<br>
                            music_data #check to make sure python is reading the file</dd>
                </dl>
            <br>

            <h2>Preparing the Data</h2>
                <dl>
                    <dt>This contains and is not limited to deleting replicants, removing outliers, etc.</dt>
                    <dt>For this example the data does not need any cleaning</dt>
                    <dt>Denote the input sets and output sets</dt>
                    <dt>Input sets are data that will be used by the model to make predictions about the output sets</dt>
                    <dt>In this case, the input sets (age and gender) will be used to determine the output set (genre)</dt>
                        <dd style="font-family:'Courier New', Courier, monospace">import pandas as pd <br>
                            music_data = pd.read_csv('music.csv')<br>
                            X = music_data.drop(columns=['genre']) #disregards the genre column and assigns it to X <br>
                            y = music_data['genre'] #assigns only the genre data to the y value</dd>
                </dl>
            <br>

            <h2>Learning and Predicting</h2>
                <dl>
                    <dt>This step uses the Scikit-Learn which contains a large amount of algorithms built in</dt>
                    <dt>This reduces our need to build one from scratch</dt>
                        <dd style="font-family:'Courier New', Courier, monospace">import pandas as pd <br>
                            from sklearn.tree import DecisionTreeClassifier<br>
                            music_data = pd.read_csv('music.csv')<br>
                            X = music_data.drop(columns=['genre']) <br>
                            y = music_data['genre']<br>
                            model = DecisionTreeClassifier() #Defines DecisionTreeClassifier as model<br>
                            model.fit(X, y) #fits out input and output sets to the model<br>
                            predictions = model.predict([[21, 1], [22, 0]]) #observing the prediction of our model<br>
                            predictions</dd>
                </dl>
            <br>

            <h2>Calculating the Accuracy</h2>
                <dl>
                    <dt>This is done by the training and test sets</dt>
                    <dt>The general rule is to allocate 70-80% of the data to training sets and 20-30% to test sets</dt>
                        <dd style="font-family: 'Courier New', Courier, monospace">import pandas as pd <br>
                            from sklearn.tree import DecisionTreeClassifier<br>
                            from sklearn.model_selection import train_test_split  <br>
                            from sklearn.metrics import accuracy_score<br>
                            music_data = pd.read_csv('music.csv')<br>
                            X = music_data.drop(columns=['genre']) <br>
                            y = music_data['genre']<br>
                            X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2) #outputs a tuple and they are all assigned a value<br>
                            model = DecisionTreeClassifier() <br>
                            model.fit(X_train, y_train) #Rewrite with the proper variables<br>
                            predictions = model.predict([X_test]) #Rewrite with proper variables<br>
                            score = accuracy_score(y_test, predictions) #compares the test set with the predicted train set and gives a score from 0-1<br>
                            score #the score will differ since the train_test_split randomly selects data from data set<br></dd>
                </dl>
            <br>

            <h2>Persisting Models</h2>
                <dl>
                    <dt>Basic implementation of building, creating, and training models</dt>
                    <dt>Used to reduce code, clutter, and model flexibility</dt>
                    <dt>Using joblib from sklearn this creates a model file that can be loaded</dt>
                        <dd style="font-family: 'Courier New', Courier, monospace">[1] import pandas as pd <br>
                            from sklearn.tree import DecisionTreeClassifier<br>
                            from sklearn.externals import joblib<br>
                            music_data = pd.read_csv('music.csv')<br>
                            X = music_data.drop(columns=['genre']) <br>
                            y = music_data['genre']<br>
                            model = DecisionTreeClassifier() <br>
                            model.fit(X, y) <br>
                            joblib.dump(model, 'music-recommender.joblib) #creates a file that has the model trained<br>
                            predictions = model.predict([[21, 1], [22, 0]])</dd>
                        <br>
                        <dd style="font-family: 'Courier New', Courier, monospace"> [2] model = joblib.load ('music-recommender.joblib) #loads the previous model file and can predict using a few short lines<br>
                            predictions = model.predcit([[21,1]])<br>
                            predictions</dd>
                </dl>
            <br>

            <h2>Visualizing the Models</h2>
                <dl>
                    <dt>This example uses a decision tree just because they are the easiest to understand</dt>
                        <dd style="font-family: 'Courier New', Courier, monospace">import pandas as pd 
                            from sklearn.tree import DecisionTreeClassifier<br>
                            from sklearn import tree<br>
                            music_data = pd.read_csv('music.csv')<br>
                            X = music_data.drop(columns=['genre']) <br>
                            y = music_data['genre']<br>
                            model = DecisionTreeClassifier() #Defines DecisionTreeClassifier as model<br>
                            model.fit(X, y)<br>
                            tree.export_graphviz(model, out_file='music-recommender.dot',
                                                    feature_names=['age', 'gender'],
                                                    class_names=sorted(y.unique()),
                                                    label='all',
                                                    round=True,
                                                    filled=True)</dd>
                </dl>
        </div>
        <div>
            <img src="img/machinelearning.gif">
        </div>
    </main>
    <div class="footer">
        <a href="music.html">&#9836;</a> Matthew Olsson, 2021.
    </div>   
</body>
</html>